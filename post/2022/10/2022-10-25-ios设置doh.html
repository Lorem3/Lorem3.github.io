<!DOCTYPE html>
<html lang="en"  _g_date="2025-10-24 12:05:07 +0800" >
  <head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" /><title>iPhone/Mac设置DoH&DoT</title><link rel="shortcut icon" type="image/x-icon" href="/logo.png" /><link rel="stylesheet" href="/assets/css/left.css" />
  

  <script>
    setTimeout(() => {
      const link = document.createElement('link');
      link.rel = 'stylesheet';
      link.href = '//no-style.kr7y.workers.dev/zeta.css?d92e2f344a';
      link.type = 'text/css';
      document.head.appendChild(link);
    }, 500);
  </script>
</head><body a="light">
    <main class="page-content" aria-label="Content"><header><div class="sidebar">

<div class="sidecontent">
<div class="avatar-title">
  <a href="/"  ><img src="/assets/image/avatar.png"  class="avatar"/> </a>

  <a href="/" class="nav-title"  > L 记事本 </a>
</div>



<nav>
  <ul class="navul">
      <li class="navli curNav">

      <a href="/" class="nav">日志</a></li>
      <li class="navli">

      <a href="/archive" class="nav">归档</a></li>
      <li class="navli">

      <a href="/tags" class="nav">标签</a></li>
      <li class="navli">

      <a href="/happylife" class="nav">HP</a></li>
      <li class="navli">

      <a href="/tags/%E8%A5%BF%E8%A5%BF%E5%92%8C%E7%93%9C%E7%93%9C" class="nav">XG</a></li>
      <li class="navli">

      <a href="/about" class="nav">关于</a></li></ul>
</nav>


</div>


</div></header>
<section class="rightsidecontent">
<div class="w">
    
    
<h2>iPhone/Mac设置DoH&DoT</h2><time datetime="2022-10-25 12:57:14 +0800">2022/10/25 Tue</time> &nbsp; &nbsp;<a href="/tags/流水账.html" class="tag"><text><nobr>#流水账</nobr></text>&nbsp;</a><a href="/tags/日常.html" class="tag"><text><nobr>#日常</nobr></text>&nbsp;</a><a href="/tags/工具.html" class="tag"><text><nobr>#工具</nobr></text>&nbsp;</a><article><h1 id="总览">总览</h1>

<p><a href="https://coding.gs/2024/06/09/available-doh/">这篇blog持续更新 👍</a></p>

<blockquote>
  <p>本机Chales 抓包 经常卡住，怀疑是DoH造成，毕竟抓了本机所有的https流量<br />
使用 DoH 吧</p>
</blockquote>

<p>DoH: DNS over https <br />
DoT: DNS over TLS</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center">\</th>
      <th style="text-align: center">DoH</th>
      <th style="text-align: center">DoT</th>
      <th style="text-align: center"> </th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">阿里DNS</td>
      <td style="text-align: center"><a href="/assets/dns/alibaba-https.mobileconfig">下载</a></td>
      <td style="text-align: center"><a href="/assets/dns/alibaba-tls.mobileconfig">下载</a></td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">DNSPod</td>
      <td style="text-align: center"><a href="/assets/dns/dnspod-https.mobileconfig">下载</a></td>
      <td style="text-align: center"><a href="/assets/dns/dnspod-tls.mobileconfig">下载</a></td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">Google</td>
      <td style="text-align: center"><a href="/assets/dns/google-https.mobileconfig">下载</a></td>
      <td style="text-align: center"><a href="/assets/dns/google-tls.mobileconfig">下载</a></td>
      <td style="text-align: center"> </td>
    </tr>
    <tr>
      <td style="text-align: center">CloudFlare</td>
      <td style="text-align: center"><a href="/assets/dns/cloudflare-https.mobileconfig">下载</a></td>
      <td style="text-align: center"><a href="/assets/dns/cloudflare-tls.mobileconfig">下载</a></td>
      <td style="text-align: center"> </td>
    </tr>
  </tbody>
</table>

<h1 id="细节">细节</h1>
<h2 id="阿里dns-doh"><a href="/assets/dns/alibaba-https.mobileconfig">阿里DNS DoH</a></h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load file:/home/runner/work/blog/blog/static/static/dns/alibaba-https.mobileconfig failed
</code></pre></div></div>

<h2 id="阿里dns-dot"><a href="/assets/dns/alibaba-tls.mobileconfig">阿里DNS DoT</a></h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load file:/home/runner/work/blog/blog/static/static/dns/alibaba-tls.mobileconfig failed
</code></pre></div></div>

<h2 id="dnspod-doh"><a href="/assets/dns/dnspod-https.mobileconfig">DNSPod DoH</a></h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load file:/home/runner/work/blog/blog/static/static/dns/dnspod-https.mobileconfig failed
</code></pre></div></div>

<h2 id="dnspod-dot"><a href="/assets/dns/dnspod-tls.mobileconfig">DNSPod DoT</a></h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load file:/home/runner/work/blog/blog/static/static/dns/dnspod-tls.mobileconfig failed
</code></pre></div></div>

<h2 id="google-doh"><a href="/assets/dns/google-https.mobileconfig">Google DoH</a></h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load file:/home/runner/work/blog/blog/static/static/dns/google-https.mobileconfig failed
</code></pre></div></div>

<h2 id="google-dot"><a href="/assets/dns/google-tls.mobileconfig">Google DoT</a></h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load file:/home/runner/work/blog/blog/static/static/dns/google-tls.mobileconfig failed
</code></pre></div></div>

<h2 id="cloudflare-doh"><a href="/assets/dns/cloudflare-https.mobileconfig">CloudFlare DoH</a></h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load file:/home/runner/work/blog/blog/static/static/dns/cloudflare-https.mobileconfig failed
</code></pre></div></div>

<h2 id="cloudflare-dot"><a href="/assets/dns/cloudflare-tls.mobileconfig">CloudFlare DoT</a></h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>load file:/home/runner/work/blog/blog/static/static/dns/cloudflare-tls.mobileconfig failed
</code></pre></div></div>

<h1 id="补充几个国内访问不错的">补充几个国内访问不错的</h1>
<p>https://101.101.101.101/dns-query <br />
  https://223.5.5.5/dns-query <br />
  https://apad.pro/dns-doh/</p>

<script>
  function rnd(len){
    return (Math.random().toString(16).substring(2) + Math.random().toString(16).substring(2)).substring(0,len).toUpperCase()
  }
  function randUUID(){
    return `${rnd(8)}-${rnd(4)}-${rnd(4)}-${rnd(4)}-${rnd(12)}`
  }
  function genDoHCfg(urlStr,ip){
    let name = new URL(urlStr).host
    let cfg = `<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd">
<plist version="1.0">
<dict>
	<key>PayloadContent</key>
	<array>
		<dict>
			<key>DNSSettings</key>
			<dict>
				<key>DNSProtocol</key>
				<string>HTTPS</string>
        ${ip ? `<key>ServerAddresses</key>
				<array>
					<string>${ip}</string>
				</array>` : ""}
				
				<key>ServerURL</key>
				<string>${urlStr}</string>
			</dict>
			<key>PayloadDescription</key>
			<string>Configures device to use ${name} Encrypted DNS over HTTPS</string>
			<key>PayloadDisplayName</key>
			<string>${name} over HTTPS</string>
			<key>PayloadIdentifier</key>
			<string>com.apple.dnsSettings.managed.${randUUID()}</string>
			<key>PayloadType</key>
			<string>com.apple.dnsSettings.managed</string>
			<key>PayloadUUID</key>
			<string>${randUUID()}</string>
			<key>PayloadVersion</key>
			<integer>1</integer>
			<key>ProhibitDisablement</key>
			<false/>
		</dict>
	</array>
	<key>PayloadDescription</key>
	<string>Adds the ${name} to Big Sur and iOS 14 based systems</string>
	<key>PayloadDisplayName</key>
	<string>${name} over HTTPS</string>
	<key>PayloadIdentifier</key>
	<string>com.paulmillr.apple-dns.${name}</string>
	<key>PayloadRemovalDisallowed</key>
	<false/>
	<key>PayloadType</key>
	<string>Configuration</string>
	<key>PayloadUUID</key>
	<string>${randUUID()}</string>
	<key>PayloadVersion</key>
	<integer>1</integer>
</dict>
</plist>
`

    const blob = new Blob([cfg ], { type: "text/plain" });
    const url = URL.createObjectURL(blob);
    
// 使用 download 属性指定文件名
    const downloadFileName = `DoHcfg-${name.replace(/\./g,'_')}.mobileconfig`;
    const a = document.createElement("a");
    a.href = url;
    a.download = downloadFileName;
    a.click();
    URL.revokeObjectURL(url);

  }
</script>

</article>

<footer class="footer">
      <p> Powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://github.com/vitock/jekyll-zeta">Jekyll-zeta</a>
     </p>
    </footer></div>
</section></main></body>
</html>
